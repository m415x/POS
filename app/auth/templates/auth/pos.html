{% extends "base_template.html" %}

{% block title %}POS{% endblock %}

{% block content %}

<!--* MOUNT VUE *-->
<section class="section-content padding-y-sm bg-default" id="app_pos">
    <div class="container-fluid py-1">

        <!--* CLIENT TABS *-->
        <ul class="nav nav-tabs" role="tablist">
            <li class="nav-item" role="presentation">
                <a class="nav-link active" data-bs-toggle="tab" href="#prod" aria-selected="true" role="tab">

                    <!-- Número de cliente -->
                    <span class="badge rounded-pill bg-primary mx-1">1</span>

                    <!-- Hora de comienzo de atención -->
                    <span class="tab__clock">00:00</span>
                </a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" data-bs-toggle="tab" href="#add" aria-selected="false" tabindex="-1" role="tab">
                    <span class="tab__plus">
                        <i class="fa-solid fa-plus"></i>
                    </span>
                </a>
            </li>
        </ul>
        <div id="myTabContent" class="tab-content">
            <div class="tab-pane fade show active" id="prod" role="tabpanel">
                <div class="mt-1 mx-2">


                    <!--* CARDS *-->
                    <div class="row">
                        <div class="col-md-8 card overflow__scroll">
                            <div class="row mt-2">

                                <!--* CARD V-FOR *-->
                                <div class="text-center col-lg-2 col-md-8 mb-4" v-for="item in items" :key="item.id">
                                    <div class="card">
                                        <div class="bg-image hover-zoom ripple ripple-surface ripple-surface-light"
                                            data-mdb-ripple-color="light">
                                            <div class="card__img">
                                                <img :src="'../../../../media/items/' + [[ item.img_name ]]"
                                                    class="card-img-top" alt="Item" />
                                            </div>
                                            <div class="mask">
                                                <div class="d-flex justify-content-start align-items-start h-100">
                                                    <!-- <span class="visually-hidden" ref="stock">[[ item.stock ]]</span> -->
                                                    <!--* STOCK V-IF-ELSE *-->
                                                    <span v-if="item.stock >= 10"
                                                        class="badge bg-success m-1 card__stock">[[ item.stock ]]</span>
                                                    <span v-else-if="item.stock > 0"
                                                        class="badge bg-warning m-1 card__stock">[[ item.stock ]]</span>
                                                    <span v-else class="badge bg-danger m-1 card__stock">SIN
                                                        STOCK</span>
                                                </div>
                                            </div>
                                            <div class="hover-overlay">
                                                <a :href="'#' + [[ item.id ]]" class="text-reset text-decoration-none add__cart" :data-item_id='[[ item.id ]]' :data-item_category="[[ item.category ]]" :data-item_name="[[ item.name ]]" :data-item_info="[[ item.info ]]" :data-item_stock="[[ item.stock ]]" :data-item_cost="[[ item.cost ]]" :data-item_price="[[ item.price ]]">
                                                    <div class="mask" style="background-color: rgba(253, 253, 253, 0.15);">
                                                        <!-- <span class="visually-hidden">[[ item.id ]]</span> -->
                                                    </div>
                                                </a>
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <h5 class="card-title mb-2 card__code">
                                                [[ item.category.toUpperCase().slice(0, 3) ]]-[[
                                                item.id.toString().padStart(5, 0) ]]
                                            </h5>
                                            <p class="text-reset text-decoration-none card__description">[[
                                                item.name.toUpperCase() ]] <br> [[ item.info ]]</p>
                                            <h6 class="mb-1 card__price">$ [[ item.price ]]</h6>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--* SHOPPING CART *-->
                        <div class="row col-4 ">
                            <div class="card">
                                <span id="cart">
                                    <div class="overflow__scroll--cart">

                                        <!-- ENCABEZADO -->
                                        <div class="d-flex justify-content-between align-items-center mb-4">
                                            <div>
                                                <p class="mb-0">Tienes 1 item en el carrito</p>
                                            </div>
                                            <div>
                                                <p class="mb-0"><span class="text-muted">Ordenar por:</span> <a
                                                        href="#!" class="text-body">precio <i
                                                            class="fas fa-angle-down mt-1"></i></a></p>
                                            </div>
                                        </div>

                                        <!-- CART ITEM -->
                                        <div class="card-body">
                                            <div class="d-flex justify-content-between" v-for="cart_item in cart_items"> 
                                                <div class="d-flex flex-row align-items-start">
                                                    <div class="ms-3">
                                                        <h6>[[ cart_item.name ]]: [[ cart_item.info ]]</h6>
                                                        <p class="small mb-0">$ [[ cart_item.price ]] / [[ cart_item.unit ]]</p>
                                                    </div>
                                                </div>
                                                <div class="d-flex flex-row align-items-start">
                                                    <div style="width: 150px;">
                                                        <h5 class="fw-normal mb-0">x [[ cart_item.quantity ]]</h5> <!--CAMBIAR POR INPUT-->
                                                    </div>
                                                    <div style="width: 80px;">
                                                        <h5 class="mb-0">$ [[ cart_item.price * cart_item.quantity ]]</h5>
                                                    </div>
                                                    <a href="#!" class="btn__del_cart_item" :data-item_id='[[ item.id ]]' style="color: #cecece;"><i
                                                            class="fas fa-trash-alt"></i></a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </span>
                            </div>



                            <!-- * CALC * -->
                            <div class="btn-toolbar card" role="toolbar" aria-label="Toolbar with button groups">
                                <div class="btn-group calculator-buttons" role="group" aria-label="First group">
                                    <button class="btn btn-secondary payment__span"><img
                                            src="{{url_for('media_icons', filename='payment.png')}}" alt="Payment"
                                            width="100" style="filter: invert();"></button>
                                    <button class="btn btn-secondary">7</button>
                                    <button class="btn btn-secondary">8</button>
                                    <button class="btn btn-secondary">9</button>
                                    <button class="btn btn-secondary">Cant</button>
                                    <button class="btn btn-secondary">4</button>
                                    <button class="btn btn-secondary">5</button>
                                    <button class="btn btn-secondary">6</button>
                                    <button class="btn btn-secondary">Desc</button>
                                    <button class="btn btn-secondary">1</button>
                                    <button class="btn btn-secondary">2</button>
                                    <button class="btn btn-secondary">3</button>
                                    <button class="btn btn-secondary">Precio</button>
                                    <button class="btn btn-secondary">+/-</button>
                                    <button class="btn btn-secondary">0</button>
                                    <button class="btn btn-secondary">.</button>
                                    <button class="btn btn-secondary">
                                        <i class="fa-solid fa-delete-left"></i>
                                    </button>
                                </div>
                            </div>

                        </div>

                    </div>
                </div>
            </div>
            <div class="tab-pane fade" id="add" role="tabpanel">
                <p>
                    FUNCION AGREGAR CLIENTE
                </p>
            </div>
        </div>
    </div>
</section>

<script>
    const array_items = JSON.parse('{{ json_items|tojson }}')
    console.log(array_items)
</script>
{% endblock %}